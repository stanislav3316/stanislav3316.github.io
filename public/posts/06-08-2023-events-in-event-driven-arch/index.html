<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Events in Event-Driver Architecture | Tech blog</title>
<meta name="keywords" content="">
<meta name="description" content="ℹ️ disclaimer
This article represented my mental model at the time of writing, but I’m always iterating on it.
Event types Building Event-Driven or Asynchronous architecture it&rsquo;s important to pay a lot of attention to events in the system. They are core elements of data flows, and should be designed properly and with care. Any futrher refactoring of these events will be painful and difficult - strict structure is our helper.">
<meta name="author" content="">
<link rel="canonical" href="https://stanislav3316.github.io/posts/06-08-2023-events-in-event-driven-arch/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://stanislav3316.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://stanislav3316.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://stanislav3316.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://stanislav3316.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://stanislav3316.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Events in Event-Driver Architecture" />
<meta property="og:description" content="ℹ️ disclaimer
This article represented my mental model at the time of writing, but I’m always iterating on it.
Event types Building Event-Driven or Asynchronous architecture it&rsquo;s important to pay a lot of attention to events in the system. They are core elements of data flows, and should be designed properly and with care. Any futrher refactoring of these events will be painful and difficult - strict structure is our helper." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://stanislav3316.github.io/posts/06-08-2023-events-in-event-driven-arch/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-06T09:03:20-08:00" />
<meta property="article:modified_time" content="2023-08-06T09:03:20-08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Events in Event-Driver Architecture"/>
<meta name="twitter:description" content="ℹ️ disclaimer
This article represented my mental model at the time of writing, but I’m always iterating on it.
Event types Building Event-Driven or Asynchronous architecture it&rsquo;s important to pay a lot of attention to events in the system. They are core elements of data flows, and should be designed properly and with care. Any futrher refactoring of these events will be painful and difficult - strict structure is our helper."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://stanislav3316.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Events in Event-Driver Architecture",
      "item": "https://stanislav3316.github.io/posts/06-08-2023-events-in-event-driven-arch/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Events in Event-Driver Architecture",
  "name": "Events in Event-Driver Architecture",
  "description": "ℹ️ disclaimer\nThis article represented my mental model at the time of writing, but I’m always iterating on it.\nEvent types Building Event-Driven or Asynchronous architecture it\u0026rsquo;s important to pay a lot of attention to events in the system. They are core elements of data flows, and should be designed properly and with care. Any futrher refactoring of these events will be painful and difficult - strict structure is our helper.",
  "keywords": [
    
  ],
  "articleBody": " ℹ️ disclaimer\nThis article represented my mental model at the time of writing, but I’m always iterating on it.\nEvent types Building Event-Driven or Asynchronous architecture it’s important to pay a lot of attention to events in the system. They are core elements of data flows, and should be designed properly and with care. Any futrher refactoring of these events will be painful and difficult - strict structure is our helper.\nThere are event types:\nCUD events (create-update-delete, they carry information about changes of the entities (aggregates) in the system) The main reason for CUD events is streaming data through the system to have different local data replicas for local usage. It helps us to eliminate network calls and use local DB instead (warehouse can access user’s data locally).\nDomain events (Business events, related to a specific domain) The domain events are about business processes and triggers. They help us to build coordination between services and accomplish business goals.\nDelta or full payload Events can carry the whole payload or delta only (changed parts only). The right choice depends on business/technical requirements and cases. Moreover, full event’s payload helps us to re-play events for new services, and sometimes not to store local state because full state is in every event you have to work with.\nStructure and event’s rules There are different types of events and all of them should be under constraints and follow these rules:\nname in past tense (ReportFilled, CardExpired, ….) immutable should have schema and version (evolving) have separated data (payload) and meta (created_at, event_id, …) blocks of a event (do not mix it) (To break these rules you should fully understand you business domain and own bounded context where are events)\nIt’s important to have unified structure with evolution, changeability possibilities. So, it’s always better to enrich events with meta information along with data or payload block. Meta block helps us to manage, evolve events and handle them in idempotency and the right way.\n{ \"data | payload\": {...}, \"meta\": { \"created_at\": ..., # or schema_id as ref \"schema\": { \"name\": \"...\", \"version\": \"...\" }, \"trace_id\": \"\", \"owner_id\": \"\", \"event_id\": \"\", \"parent_event_id\": \"...\", ... } } “data or payload” - carries event’s information about what happened in the system (this block is versioning using “meta.schema”) “meta.created_at” - time when event was created “meta.schema” or “meta.schema_id” - schema of the data (payload) block [optional] “meta.trace_id” - for tracing (Jaeger, …) [optional] “meta.owner_id” - the owner of the event “meta.event_id” - unique event identificator for idempotency [optional] “meta.parent_event_id” - parent identificator for ordering or chains Anti-corruption layer When you got events from external system, different bounded context or send events outside it’s important not to send events as is. Instead, use different event’s models not internal ones (to make system flexible and robust for further changes).\nConclusion carefully approach the design of events (it’s a core!) think about evolvability learn more about your domain and bounded context learn more about business/technical requirements and constraints Links Cloud Events Specification Anti-corruption Layer pattern Event-Driven What Is Event-Driven Architecture ",
  "wordCount" : "509",
  "inLanguage": "en",
  "datePublished": "2023-08-06T09:03:20-08:00",
  "dateModified": "2023-08-06T09:03:20-08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://stanislav3316.github.io/posts/06-08-2023-events-in-event-driven-arch/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Tech blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://stanislav3316.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://stanislav3316.github.io/" accesskey="h" title="Tech blog (Alt + H)">Tech blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Events in Event-Driver Architecture
    </h1>
    <div class="post-meta"><span title='2023-08-06 09:03:20 -0800 -0800'>August 6, 2023</span>

</div>
  </header> 
  <div class="post-content"><blockquote>
<p><strong>ℹ️ disclaimer</strong></p>
<p>This article represented my mental model at the time of writing, but I’m always iterating on it.</p>
</blockquote>
<h3 id="event-types">Event types<a hidden class="anchor" aria-hidden="true" href="#event-types">#</a></h3>
<p>Building Event-Driven or Asynchronous architecture it&rsquo;s important to pay a lot of attention to events in the system.
They are core elements of data flows, and should be designed properly and with care. Any futrher refactoring of these events will be painful and difficult - strict structure is our helper.</p>
<p>There are event types:</p>
<ul>
<li>CUD events (create-update-delete, they carry information about changes of the entities (aggregates) in the system)</li>
</ul>
<p><img loading="lazy" src="/1/1.jpeg" alt="![Alt text](../assets/img/2023&amp;ndash;8-06-events-in-event-driver-arch/1.jpeg)"  />
</p>
<p>The main reason for CUD events is streaming data through the system to have different local data replicas for local usage. It helps us to eliminate network calls and use local DB instead (warehouse can access user&rsquo;s data locally).</p>
<ul>
<li>Domain events (Business events, related to a specific domain)
<img loading="lazy" src="/1/2.jpg" alt="![Alt text](../assets/img/2023&amp;ndash;8-06-events-in-event-driver-arch/1.jpeg)"  />
</li>
</ul>
<p>The domain events are about business processes and triggers. They help us to build coordination between services and accomplish business goals.</p>
<hr>
<h3 id="delta-or-full-payload">Delta or full payload<a hidden class="anchor" aria-hidden="true" href="#delta-or-full-payload">#</a></h3>
<p>Events can carry the whole payload or delta only (changed parts only). The right choice depends on business/technical requirements and cases. Moreover, full event&rsquo;s payload helps us to re-play events for new services, and sometimes not to store local state because full state is in every event you have to work with.</p>
<p><img loading="lazy" src="/1/3.jpg" alt="![Alt text](../assets/img/2023&amp;ndash;8-06-events-in-event-driver-arch/1.jpeg)"  />
</p>
<hr>
<h3 id="structure-and-events-rules">Structure and event&rsquo;s rules<a hidden class="anchor" aria-hidden="true" href="#structure-and-events-rules">#</a></h3>
<p>There are different types of events and all of them should be under constraints and follow these rules:</p>
<ul>
<li>name in past tense (ReportFilled, CardExpired, &hellip;.)</li>
<li>immutable</li>
<li>should have schema and version (evolving)</li>
<li>have separated data (payload) and meta (created_at, event_id, &hellip;) blocks of a event (do not mix it)</li>
</ul>
<p>(To break these rules you should fully understand you business domain and own bounded context where are events)</p>
<p>It&rsquo;s important to have unified structure with evolution, changeability possibilities. So, it&rsquo;s always better to enrich events with meta information along with data or payload block. Meta block helps us to manage, evolve events and handle them in idempotency and the right way.</p>
<pre tabindex="0"><code>{
  &#34;data | payload&#34;: {...},
  &#34;meta&#34;: {
    &#34;created_at&#34;: ...,
    # or schema_id as ref
    &#34;schema&#34;: {
      &#34;name&#34;: &#34;...&#34;,
      &#34;version&#34;: &#34;...&#34;
    },
    &#34;trace_id&#34;: &#34;&#34;,
    &#34;owner_id&#34;: &#34;&#34;,
    &#34;event_id&#34;: &#34;&#34;,
    &#34;parent_event_id&#34;: &#34;...&#34;,
    ...
  }
}
</code></pre><ol>
<li>&ldquo;data or payload&rdquo; - carries event&rsquo;s information about what happened in the system (this block is versioning using &ldquo;meta.schema&rdquo;)</li>
<li>&ldquo;meta.created_at&rdquo; - time when event was created</li>
<li>&ldquo;meta.schema&rdquo; or &ldquo;meta.schema_id&rdquo; - schema of the data (payload) block</li>
<li>[optional] &ldquo;meta.trace_id&rdquo; - for tracing (Jaeger, &hellip;)</li>
<li>[optional] &ldquo;meta.owner_id&rdquo; - the owner of the event</li>
<li>&ldquo;meta.event_id&rdquo; - unique event identificator for idempotency</li>
<li>[optional] &ldquo;meta.parent_event_id&rdquo; - parent identificator for ordering or chains</li>
</ol>
<hr>
<h3 id="anti-corruption-layer">Anti-corruption layer<a hidden class="anchor" aria-hidden="true" href="#anti-corruption-layer">#</a></h3>
<p><img loading="lazy" src="/1/4.jpg" alt="![Alt text](../assets/img/2023&amp;ndash;8-06-events-in-event-driver-arch/1.jpeg)"  />
</p>
<p>When you got events from external system, different bounded context or send events outside it&rsquo;s important not to send events as is.
Instead, use different event&rsquo;s models not internal ones (to make system flexible and robust for further changes).</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<ul>
<li>carefully approach the design of events (it&rsquo;s a core!)</li>
<li>think about evolvability</li>
<li>learn more about your domain and bounded context</li>
<li>learn more about business/technical requirements and constraints</li>
</ul>
<h2 id="links">Links<a hidden class="anchor" aria-hidden="true" href="#links">#</a></h2>
<ol>
<li><a href="https://cloudevents.io">Cloud Events Specification</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer">Anti-corruption Layer pattern</a></li>
<li><a href="https://martinfowler.com/articles/201701-event-driven.html">Event-Driven</a></li>
<li><a href="https://blog.hubspot.com/website/event-driven-architecture#:~:text=Event%2Ddriven%20architecture%20(EDA),share%20information%20and%20accomplish%20tasks.">What Is Event-Driven Architecture</a></li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://stanislav3316.github.io/">Tech blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
